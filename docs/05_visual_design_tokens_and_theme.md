# 段階5: ビジュアルデザイン・トークンとStreamlitテーマ定義

フェーズ2で整理した情報設計を基盤に、「知性・簡潔・信頼」を感じさせるダッシュボード体験を実現するためのビジュアルデザインをデザイン・トークンとして整理する。本ガイドは配色・タイポグラフィ・レイアウト・コンポーネントの基本ルールを統一し、Streamlit実装時に即座に反映できるテーマ設定例を提示する。

## デザイン・トークン一覧

### 色
| カテゴリー | 変数名 | 値/仕様 | 用途 |
| --- | --- | --- | --- |
| 色 | `primaryColor` | `#0B1F3B` | ブランドの主色。ダークネイビーで落ち着きと専門性を表現。KPIカード背景やグラフ軸などに使用。 |
| 色 | `secondaryColor` | `#5A6B7A` | 補助色。グレーがかったブルーで落ち着いたトーンを保ちつつ情報を引き立てる。サイドバーやボタン枠線に使用。 |
| 色 | `accentColor` | `#1E88E5` | アクセント色。重要情報やアクションを強調する青色。リンクやハイライト、選択状態の表示に使用。 |
| 色 | `backgroundColor` | `#F7F8FA` | 全体の背景色。淡いグレーで高コントラストを実現。 |
| 色 | `surfaceColor` | `#FFFFFF` | カードやモーダルの背景色。 |
| 色 | `textColor` | `#1A1A1A` | 本文用のメインテキスト色。 |
| 色 | `successColor` | `#4CAF50`（彩度80%） | 成功や増加を示す緑色。指標の増加や目標達成時に利用。 |
| 色 | `warningColor` | `#FBC02D`（彩度80%） | 警告を示す黄色。目標未達や注意喚起に使用。 |
| 色 | `errorColor` | `#E53935`（彩度80%） | エラーや減少を示す赤色。指標の悪化やシステムエラー時に使用。 |

### タイポグラフィ
| カテゴリー | 変数名 | 値/仕様 | 用途 |
| --- | --- | --- | --- |
| タイポグラフィ | `fontFamily` | `'Inter', 'Source Sans 3', sans-serif` | 読みやすくモダンなゴシック体。英数字は等幅フォントに切り替え可能。 |
| タイポグラフィ | `fontSize.body` | `14–16px`（行間1.4–1.6） | 本文サイズ。スマートフォンでは16pxを基準に可読性を確保。 |
| タイポグラフィ | `fontSize.heading` | `22–28px` | 見出しサイズ。階層に応じて段階的に調整。 |
| タイポグラフィ | `fontSize.numeric` | `1.5rem`（タブラー数字） | KPIカードやグラフ軸で使用。桁区切りを明示して読みやすくする。 |

### レイアウト
| カテゴリー | 変数名 | 値/仕様 | 用途 |
| --- | --- | --- | --- |
| レイアウト | `layoutWidth` | `wide` | `st.set_page_config(layout="wide")`で設定。余白を十分に取り、情報を三段階に分ける。 |
| レイアウト | `gridSystem` | `12カラム` | コンポーネント配置を柔軟に行うための仮想グリッド。各カードやグラフは4または6カラム単位で配置。 |
| レイアウト | `spacingUnit` | `8px` | 余白・パディング・マージンは8の倍数で統一。 |
| レイアウト | `cardRadius` | `8–12px` | カードや入力ボックスの角丸。過度な丸みを避け知的な印象を維持。 |
| レイアウト | `cardShadow` | `0 1px 4px rgba(0,0,0,0.1)` | 控えめな影でカードと背景を区別。 |

### コンポーネント
| コンポーネント | 基本スタイル | 運用ルール |
| --- | --- | --- |
| KPIカード | 背景=`surfaceColor`、枠線=`transparent`、数値=`fontSize.numeric`、前期比=小さな矢印アイコン＋デルタ色（`success`/`warning`/`error`） | 主要指標3つに使用し、カード全体をクリック可能な領域として詳細ページへ遷移できるようにする。 |
| セグメントコントロール | タブやラジオボタンを水平配置。選択状態は`accentColor`で強調し、未選択は`secondaryColor`で低彩度表示。 | 売上/粗利/在庫/資金の切替に使用。ショートカットキー操作に対応させる。 |
| トグル | スイッチ形状。背景は`secondaryColor`、ON時はノブと軌道を`accentColor`に。 | サンプルデータ利用や設定のON/OFFに利用。ラベルは左右どちらかに固定し視線移動を最小化。 |
| ツールチップ | 背景=`secondaryColor`、文字色=`#FFFFFF`、角丸=`cardRadius`、影=`cardShadow`。 | KPIや専門用語の説明に活用し、遅延表示（300ms程度）で意図せず表示されないよう制御。 |

## Streamlitテーマ設定例

プロジェクトルートに`.streamlit/config.toml`を配置すると、以下のテーマ設定が全ページで共通適用される。`[custom]`セクションは標準テーマには直接反映されないため、必要に応じて`st.markdown`でCSSを追加する。

```toml
[theme]
primaryColor = "#0B1F3B"
backgroundColor = "#F7F8FA"
secondaryBackgroundColor = "#FFFFFF"
textColor = "#1A1A1A"
secondaryTextColor = "#5A6B7A"
font = "sans serif"

[custom]
accentColor = "#1E88E5"
successColor = "#4CAF50"
warningColor = "#FBC02D"
errorColor = "#E53935"
spacingUnit = 8
cardRadius = 10
cardShadow = "0 1px 4px rgba(0,0,0,0.1)"
fontFamily = "Inter, 'Source Sans 3', sans-serif"
```

## 実装上のポイント

- **色のコントラスト**: 背景と文字はWCAG 2.1 AA基準（4.5:1以上）を下回らないよう配色を選び、濃紺背景では白系、淡い背景では濃いグレーを組み合わせる。成功・警告・エラー色は彩度を抑え、過度な点滅やアニメーションを避ける。
- **フォントの最適化**: `Inter`のタブラー数字（`font-feature-settings: "tnum";`）を活用し、KPIの桁揃えを行う。段落は最大70文字程度で改行し、余白と可読性を両立する。
- **レスポンシブ対応**: 12カラムグリッドを基準に、画面幅が狭い場合はカラム結合を行い縦並びへ切り替える。`st.columns`の比率を`(1, 1)`や`(2, 1)`に変更して情報優先度を調整する。
- **コンポーネントの一貫性**: KPIカード、ボタン、入力欄は同じ角丸・影・タイポグラフィを適用し、状態変化はカラーとアイコンの両面で示す。ツールチップやヘルプアイコンを要所に配置し、非ITユーザーにも迷いを与えない補助情報を提供する。
- **カスタムCSSの適用**: `[custom]`で定義した値は`st.session_state`や`st.markdown`からCSS変数として利用できる。例: `.stButton>button { border-radius: 10px; box-shadow: 0 1px 4px rgba(0,0,0,0.1); }`。

このデザイン・トークン群をベースに、次フェーズではクリック数削減を目的とした行動導線設計と、指標の理解を促す視覚化最適化を進める。
